# CraftD – Local KMP Testing Guide

This guide explains how to build and publish the CraftD modules to your local Maven repository, then run the **KMP-Sample** app using those locally published artifacts.

## Prerequisites

* JDK 21+
* Gradle Wrapper (`./gradlew`)
* macOS or Linux
* Kotlin Multiplatform toolchain installed (Xcode required for iOS builds)

---

## 1) Run the local publish script

From the **android_kmp** repository root, run:

```bash
chmod +x generate_local_libraries.sh
./generate_local_libraries.sh
```

What this script does automatically:

* Updates the `VERSION` / `VERSION_NAME` fields inside
  `craftd-core/gradle.properties` and `craftd-compose/gradle.properties`
* Builds **release** artifacts of each module
* Publishes both modules to your `mavenLocal()`
* Updates `KMP-Sample/gradle/libs.versions.toml`
  (key: `craftdCompose`) to the same version you just published

To force a specific version:

```bash
VERSION=1.0.5-local ./generate_local_libraries.sh
```

Published artifacts will be located at:

```
~/.m2/repository/io/github/codandotv/
```

---

## 2) Ensure the sample uses `mavenLocal()`

Inside **KMP-Sample**, confirm your `repositories` block contains:

```kotlin
repositories {
    mavenLocal()
    mavenCentral()
}
```

`mavenLocal()` must appear before `mavenCentral()`.

---

## 3) Build and run the sample app

After running the script (which updates everything for you):

### Android

```bash
./gradlew :composeApp:installDebug
```

### iOS (XCFramework)

```bash
./gradlew :composeApp:assembleComposeAppDebugXCFramework
```

Or simply open the sample project:

```
File > Open > android_kmp/KMP-Sample
```

---

## ✅ Finished!

Your environment is now ready for local testing of CraftD KMP modules using the exact version generated by the script.
